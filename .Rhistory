re_formula = 1 ~ 1)
draws
draws1
mcmc_intervals(
posterior1,
prob = 0.5,
prob_outer = 0.95,
point_est = "mean"
)
mcmc_intervals(
posterior2,
prob = 0.5,
prob_outer = 0.95,
point_est = "mean"
)
ggplot(sites %>% filter(surveyYear == 2021), aes(y = n, x = sandRatio)) +
geom_boxplot() + geom_quasirandom()
sjPlot::plot_model(m_1, type = "est")
sjPlot::plot_model(m_1, type = "pred", terms = c(
"sandRatio", "substrateDepth", "surveyYear_fac", "exposition"
))
sjPlot::plot_model(m, type = "pred", terms = c(
"targetType", "sandRatio", "surveyYear_fac", "exposition"
))
sjPlot::plot_model(m_1, type = "pred", terms = c(
"targetType", "sandRatio", "surveyYear_fac", "exposition"
))
sjPlot::plot_model(m_1, type = "pred", terms = c(
"sandRatio", "seedDensity", "surveyYear_fac", "exposition"
))
sjPlot::plot_model(m_1, type = "pred", terms = c(
"seedDensity", "surveyYear_fac", "exposition"
))
sjPlot::plot_model(m_1, type = "pred", terms = c(
"seedDensity", "exposition", "surveyYear_fac"
))
(emm <- emmeans(m, revpairwise ~ targetType + sandRatio |
exposition | surveyYear_fac, type = "response"))
(emm <- emmeans(m_1, revpairwise ~ targetType + sandRatio |
exposition | surveyYear_fac, type = "response"))
sjPlot::plot_model(m_1, type = "est")
sjPlot::plot_model(m31_flat, type = "est")
sjPlot::plot_model(m_1, type = "pred", terms = c(
"sandRatio", "surveyYear_fac", "exposition"
))
sjPlot::plot_model(m_1, type = "pred", terms = c(
"sandRatio", "exposition", "surveyYear_fac"
))
sjPlot::plot_model(m_1, type = "est")
sjPlot::plot_model(m_1, type = "pred", terms = c(
"targetType", "exposition", "surveyYear_fac"
))
sjPlot::plot_model(m_1, type = "pred", terms = c(
"seedDensity", "exposition", "surveyYear_fac"
))
sjPlot::plot_model(m_1, type = "pred", terms = c(
"sandRatio", "substrateDepth", "surveyYear_fac", "exposition"
))
(emm <- emmeans(m_1, revpairwise ~ substrateDepth + sandRatio |
exposition | surveyYear_fac, type = "response"))
m_1 <- m31
m_2 <- m_simple1
bayes_R2(m_1, probs = c(0.05, 0.5, 0.95),
re_formula =  ~ (1 | block/plot) + (1 | botanist_year))
bayes_R2(m_2, probs = c(0.05, 0.5, 0.95),
re_formula =  ~ (1 | block/plot) + (1 | botanist_year))
bayes_R2(m_1, probs = c(0.05, 0.5, 0.95),
re_formula = 1 ~ 1)
bayes_R2(m_2, probs = c(0.05, 0.5, 0.95),
re_formula = 1 ~ 1)
m31 <- brm(n ~ (targetType + exposition + sandRatio + surveyYear_fac)^2 +
substrateDepth + seedDensity +
substrateDepth:sandRatio +
seedDensity:exposition +
targetType:exposition:surveyYear_fac +
sandRatio:exposition:surveyYear_fac +
seedDensity:exposition:surveyYear_fac +
(1 + exposition | block/plot) + (1 | botanist_year),
data = sites,
family = gaussian("identity"),
prior = c(
set_prior("normal(0, 3)", class = "b"),
set_prior("normal(0, 3)", class = "b", coef = "expositionnorth"),
set_prior("cauchy(0, 1)", class = "sigma")
),
chains = chains,
iter = iter,
thin = thin,
warmup = floor(iter / 2),
save_pars = save_pars(all = TRUE),
cores = parallel::detectCores(),
seed = 123)
m_1 <- m31
bayes_R2(m_1, probs = c(0.05, 0.5, 0.95),
re_formula =  ~ (1 | block/plot) + (1 | botanist_year))
bayes_R2(m_1, probs = c(0.05, 0.5, 0.95),
re_formula = 1 ~ 1)
sites %>%
data_grid(exposition) %>%
add_predicted_draws(m_1) %>%
ggplot(aes(x = .prediction, y = exposition)) +
stat_slab()
sites %>%
tidybayes::data_grid(exposition) %>%
add_predicted_draws(m_1) %>%
ggplot(aes(x = .prediction, y = exposition)) +
stat_slab()
sites %>%
modelr::data_grid(exposition) %>%
add_predicted_draws(m_1) %>%
ggplot(aes(x = .prediction, y = exposition)) +
stat_slab()
library(modelr)
sites %>%
modelr::data_grid(exposition) %>%
add_predicted_draws(m_1) %>%
ggplot(aes(x = .prediction, y = exposition)) +
stat_slab()
### Packages ###
library(here)
library(tidyverse)
library(ggbeeswarm)
library(brms)
library(DHARMa)
library(bayesplot)
library(loo)
library(tidybayes)
library(emmeans)
sites %>%
modelr::data_grid(exposition) %>%
add_predicted_draws(m_1) %>%
ggplot(aes(x = .prediction, y = exposition)) +
stat_slab()
sites %>%
modelr::data_grid(exposition) %>%
add_epred_draws(m) %>%
ggplot(aes(x = .epred, y = exposition)) +
stat_pointinterval(.width = c(.5, .95))
sites %>%
modelr::data_grid(exposition) %>%
add_epred_draws(m_1) %>%
ggplot(aes(x = .epred, y = exposition)) +
stat_pointinterval(.width = c(.5, .95))
sites %>%
modelr::data_grid(exposition) %>%
add_epred_draws(m_1) %>%
ggplot(aes(x = .epred, y = exposition)) +
stat_pointinterval(.width = c(.5, .95), inherit.aes = FALSE)
sites %>%
modelr::data_grid(exposition) %>%
add_epred_draws(m_1) %>%
ggplot(aes(x = .epred, y = exposition))# +
sites %>%
modelr::data_grid(exposition) %>%
add_epred_draws(m_1) #%>%
data <- sites %>%
modelr::data_grid(exposition) #%>%
View(data)
data <- sites %>%
modelr::data_grid(exposition) %>%
add_epred_draws(m_1) #%>%
data <- sites %>%
modelr::data_grid(exposition, block) %>%
add_epred_draws(m_1) #%>%
data <- sites %>%
modelr::data_grid(exposition, block, plot) %>%
add_epred_draws(m_1) #%>%
data <- sites %>%
modelr::data_grid(exposition, block, plot, botanist_year) %>%
add_epred_draws(m_1) #%>%
data <- sites %>%
modelr::data_grid(exposition, block, plot, botanist_year) %>%
add_epred_draws(m_1, allow_new_levels O TRUE) #%>%
data <- sites %>%
modelr::data_grid(exposition, block, plot, botanist_year) %>%
add_epred_draws(m_1, allow_new_levels = TRUE) #%>%
data <- sites %>%
modelr::data_grid(exposition, substrateDepth, sandRatio,
targetType, seedDensity, surveyYear_fac,
block, plot, botanist_year) %>%
add_epred_draws(m_1, allow_new_levels = TRUE) #%>%
### Load data ###
sites <- read_csv("data_processed_sites.csv",
col_names = TRUE, na = c("na", "NA"), col_types =
cols(
.default = "?",
block = "f",
exposition = "f",
sandRatio = "f",
substrateDepth = "f",
seedDensity = "f",
targetType = "f"
)) %>%
filter(
!str_detect(id, "C") & presabu == "presence" & surveyYear != "seeded"
) %>%
mutate(
n = fcs_target,
surveyYear_fac = factor(surveyYear),
targetType = factor(targetType),
botanist_year = str_c(botanist, surveyYear, sep = " "),
botanist_year = factor(botanist_year),
surveyYear = as.double(surveyYear)
) %>%
select(
id, plot, block, exposition, sandRatio, substrateDepth, targetType,
seedDensity, surveyYear_fac, surveyYear, botanist_year, n
)
View(sites)
### Load data ###
sites <- read_csv("data_processed_sites.csv",
col_names = TRUE, na = c("na", "NA"), col_types =
cols(
.default = "?",
block = "f",
exposition = "f",
sandRatio = "f",
substrateDepth = "f",
seedDensity = "f",
targetType = "f"
)) %>%
filter(
!str_detect(id, "C") & presabu == "presence" & surveyYear != "seeded"
) %>%
mutate(
n = fcs_target,
surveyYear_fac = factor(surveyYear),
targetType = factor(targetType),
botanist_year = str_c(botanist, surveyYear, sep = " "),
botanist_year = factor(botanist_year),
sandRatio = factor(sandRatio),
surveyYear = as.double(surveyYear)
) %>%
select(
id, plot, block, exposition, sandRatio, substrateDepth, targetType,
seedDensity, surveyYear_fac, surveyYear, botanist_year, n
)
data <- sites %>%
modelr::data_grid(exposition, substrateDepth, sandRatio,
targetType, seedDensity, surveyYear_fac,
block, plot, botanist_year) %>%
add_epred_draws(m_1, allow_new_levels = TRUE) #%>%
### Load data ###
sites <- read_csv("data_processed_sites.csv",
col_names = TRUE, na = c("na", "NA"), col_types =
cols(
.default = "?",
block = "f",
exposition = "f",
sandRatio = "f",
substrateDepth = "f",
seedDensity = "f",
targetType = "f"
)) %>%
filter(
!str_detect(id, "C") & presabu == "presence" & surveyYear != "seeded"
) %>%
mutate(
n = fcs_target,
surveyYear_fac = factor(surveyYear),
targetType = factor(targetType),
botanist_year = str_c(botanist, surveyYear, sep = " "),
botanist_year = factor(botanist_year),
sandRatio = factor(sandRatio),
substrateDepth = factor(substrateDepth),
surveyYear = as.double(surveyYear)
) %>%
select(
id, plot, block, exposition, sandRatio, substrateDepth, targetType,
seedDensity, surveyYear_fac, surveyYear, botanist_year, n
)
data <- sites %>%
modelr::data_grid(exposition, substrateDepth, sandRatio,
targetType, seedDensity, surveyYear_fac,
block, plot, botanist_year) %>%
add_epred_draws(m_1, allow_new_levels = TRUE) #%>%
### Load data ###
sites <- read_csv("data_processed_sites.csv",
col_names = TRUE, na = c("na", "NA"), col_types =
cols(
.default = "?",
block = "f",
exposition = "f",
sandRatio = "f",
substrateDepth = "f",
seedDensity = "f",
targetType = "f"
)) %>%
filter(
!str_detect(id, "C") & presabu == "presence" & surveyYear != "seeded"
) %>%
mutate(
n = fcs_target,
surveyYear_fac = factor(surveyYear),
targetType = factor(targetType),
botanist_year = str_c(botanist, surveyYear, sep = " "),
botanist_year = factor(botanist_year),
sandRatio = factor(sandRatio),
substrateDepth = factor(substrateDepth),
seedDensity = factor(seedDensity),
surveyYear = as.double(surveyYear)
) %>%
select(
id, plot, block, exposition, sandRatio, substrateDepth, targetType,
seedDensity, surveyYear_fac, surveyYear, botanist_year, n
)
data <- sites %>%
modelr::data_grid(exposition, substrateDepth, sandRatio,
targetType, seedDensity, surveyYear_fac,
block, plot, botanist_year) %>%
add_epred_draws(m_1, allow_new_levels = TRUE) #%>%
data <- sites %>%
modelr::data_grid(exposition, substrateDepth, sandRatio,
targetType, seedDensity, surveyYear_fac,
block, plot, botanist_year) %>%
add_epred_draws(m_1, allow_new_levels = FALSE) #%>%
### Load data ###
sites <- read_csv("data_processed_sites.csv",
col_names = TRUE, na = c("na", "NA"), col_types =
cols(
.default = "?",
block = "f",
exposition = "f",
sandRatio = "f",
substrateDepth = "f",
seedDensity = "f",
targetType = "f"
)) %>%
filter(
!str_detect(id, "C") & presabu == "presence" & surveyYear != "seeded"
) %>%
mutate(
n = fcs_target,
surveyYear_fac = factor(surveyYear),
targetType = factor(targetType),
botanist_year = str_c(botanist, surveyYear, sep = " "),
botanist_year = factor(botanist_year),
sandRatio = factor(sandRatio),
substrateDepth = factor(substrateDepth),
seedDensity = factor(seedDensity),
block = factor(block),
surveyYear = as.double(surveyYear)
) %>%
select(
id, plot, block, exposition, sandRatio, substrateDepth, targetType,
seedDensity, surveyYear_fac, surveyYear, botanist_year, n
)
### Load data ###
sites <- read_csv("data_processed_sites.csv",
col_names = TRUE, na = c("na", "NA"), col_types =
cols(
.default = "?",
block = "f",
exposition = "f",
sandRatio = "f",
substrateDepth = "f",
seedDensity = "f",
targetType = "f"
)) %>%
filter(
!str_detect(id, "C") & presabu == "presence" & surveyYear != "seeded"
) %>%
mutate(
n = fcs_target,
surveyYear_fac = factor(surveyYear),
targetType = factor(targetType),
botanist_year = str_c(botanist, surveyYear, sep = " "),
botanist_year = factor(botanist_year),
sandRatio = factor(sandRatio),
substrateDepth = factor(substrateDepth),
seedDensity = factor(seedDensity),
block = factor(block),
plot = factor(plot),
surveyYear = as.double(surveyYear)
) %>%
select(
id, plot, block, exposition, sandRatio, substrateDepth, targetType,
seedDensity, surveyYear_fac, surveyYear, botanist_year, n
)
data <- sites %>%
modelr::data_grid(exposition, substrateDepth, sandRatio,
targetType, seedDensity, surveyYear_fac,
block, plot, botanist_year) %>%
add_epred_draws(m_1, allow_new_levels = FALSE) #%>%
### Load data ###
sites <- read_csv("data_processed_sites.csv",
col_names = TRUE, na = c("na", "NA"), col_types =
cols(
.default = "?",
block = "f",
exposition = "f",
sandRatio = "f",
substrateDepth = "f",
seedDensity = "f",
targetType = "f"
)) %>%
filter(
!str_detect(id, "C") & presabu == "presence" & surveyYear != "seeded"
) %>%
mutate(
n = fcs_target,
surveyYear_fac = factor(surveyYear),
targetType = factor(targetType),
botanist_year = str_c(botanist, surveyYear, sep = " "),
botanist_year = factor(botanist_year),
sandRatio = factor(sandRatio),
substrateDepth = factor(substrateDepth),
seedDensity = factor(seedDensity),
block = factor(block),
plot = factor(plot),
id = factor(id),
surveyYear = as.double(surveyYear)
) %>%
select(
id, plot, block, exposition, sandRatio, substrateDepth, targetType,
seedDensity, surveyYear_fac, surveyYear, botanist_year, n
)
data <- sites %>%
modelr::data_grid(exposition, substrateDepth, sandRatio,
targetType, seedDensity, surveyYear_fac,
block, plot, botanist_year) %>%
add_epred_draws(m_1, allow_new_levels = FALSE) #%>%
data <- sites %>%
modelr::data_grid(exposition, substrateDepth, sandRatio,
targetType, seedDensity, surveyYear_fac,
block, plot, botanist_year) %>%
add_epred_draws(m_1, allow_new_levels = TRUE) #%>%
m_1 %>%
spread_draws(condition_mean[exposition]) %>%
ggplot(aes(y = fct_rev(exposition), x = condition_mean)) +
stat_pointinterval()
m_1 %>%
spread_draws(exposition_mean[exposition]) %>%
ggplot(aes(y = fct_rev(exposition), x = exposition_mean)) +
stat_pointinterval()
m_1 %>%
spread_draws(b_exposition[exposition, term])
m_1 %>%
spread_draws(b_expositionnorth[expositionnorth, term])
get_variables(m_1)
head(get_variables(m_1))
head(get_variables(m_1), 10)
head(get_variables(m_1), 20)
m_1 %>%
spread_draws(b_expositionnorth[b_expositionnorth, term])
m_1 %>%
spread_draws(b_expositionnorth[b_expositionnorth, b_Intercept])
m_1 %>%
spread_draws(b_expositionnorth[c, t])
m_1 %>%
spread_draws(b_expositionnorth)
m_1 %>%
spread_draws(b_expositionnorth, b_targetTypedry_grassland)
m_1 %>%
spread_draws(b_Intercept, b_expositionnorth) %>%
mean_qi(condition_mean = b_Intercept + b_expositionnorth)
m_1 %>%
spread_draws(b_Intercept, b_expositionnorth) %>%
mean_qi(condition_mean = b_Intercept + b_expositionnorth, .width = c(.95, .66)) %>%
ggplot(aes(y = exposition, x = condition_mean, xmin = .lower, xmax = .upper)) +
geom_pointinverval()
m_1 %>%
spread_draws(b_Intercept, b_expositionnorth) %>%
mean_qi(condition_mean = b_Intercept + b_expositionnorth, .width = c(.95, .66)) %>%
ggplot(aes(y = exposition, x = condition_mean, xmin = .lower, xmax = .upper)) +
geom_pointintverval()
m_1 %>%
spread_draws(b_Intercept, b_expositionnorth) %>%
mean_qi(condition_mean = b_Intercept + b_expositionnorth, .width = c(.95, .66)) %>%
ggplot(aes(y = exposition, x = condition_mean, xmin = .lower, xmax = .upper)) +
geom_pointinterval()
m_1 %>%
spread_draws(b_Intercept, b_expositionnorth) %>%
mean_qi(condition_mean = b_Intercept + b_expositionnorth, .width = c(.95, .66)) %>%
ggplot(aes(y = b_expositionnorth, x = condition_mean, xmin = .lower, xmax = .upper)) +
geom_pointinterval()
m_1 %>%
spread_draws(b_Intercept, b_expositionnorth) %>%
mean_qi(condition_mean = b_Intercept + b_expositionnorth, .width = c(.95, .66)) %>%
ggplot(aes(y = point, x = condition_mean, xmin = .lower, xmax = .upper)) +
geom_pointinterval()
m_1 %>%
spread_draws(b_Intercept, b_expositionnorth) %>%
mean_qi(condition_mean = b_Intercept + b_expositionnorth, .width = c(.95, .66)) %>%
ggplot(aes(y = .point, x = condition_mean, xmin = .lower, xmax = .upper)) +
geom_pointinterval()
sites %>%
data_grid(exposition)
sites %>%
data_grid(exposition) %>%
add_epred_draws(m_1, dpar = TRUE, category = "targetType") %>%
ggplot(aes(x = exposition, y = .epred, color = targetType)) +
stat_pointinterval(position = position_dodge(width = .4)) +
scale_size_continuous(guide = "none") +
scale_color_manual(values = brewer.pal(6, "Blues")[-c(1,2)])
sites %>%
data_grid(exposition, block, plot, botanist_year) %>%
add_epred_draws(m_1, dpar = TRUE, category = "targetType") %>%
ggplot(aes(x = exposition, y = .epred, color = targetType)) +
stat_pointinterval(position = position_dodge(width = .4)) +
scale_size_continuous(guide = "none") +
scale_color_manual(values = brewer.pal(6, "Blues")[-c(1,2)])
View(data)
data <- sites %>%
data_grid(exposition, block, plot, botanist_year) %>%
add_epred_draws(m_1, dpar = TRUE, category = "targetType") #%>%
data <- sites %>%
data_grid(exposition, block, botanist_year) %>%
add_epred_draws(m_1, dpar = TRUE, category = "targetType") #%>%
sjPlot::plot_model(m_1, type = "pred", terms = c(
"sandRatio", "substrateDepth", "surveyYear_fac", "exposition"
))
