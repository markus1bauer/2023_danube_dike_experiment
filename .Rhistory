drop_na()
View(traitsLHS)
filter(species, group != "tree" & group != "shrub")
traits %>%
filter(group != "tree" & group != "shrub") %>%
anti_join(species)
traits %>%
filter(group != "tree" & group != "shrub") %>%
semi_join(species, by = "name")
traits %>%
filter(group != "tree" & group != "shrub") %>%
semi_join(species, by = "name") %>%
length()
traits %>%
filter(group != "tree" & group != "shrub") %>%
right_join(species, by = "name") %>%
length()
traits %>%
filter(group != "tree" & group != "shrub") %>%
left_join(species, by = "name") %>%
length()
traits %>%
filter(group != "tree" & group != "shrub") %>%
left_join(species, by = "name")
traits %>%
filter(group != "tree" & group != "shrub") %>%
left_join(species, by = "name") %>%
length(name)
traits %>%
filter(group != "tree" & group != "shrub") %>%
left_join(species, by = "name") %>%
count()
traitsLHS <- traits %>%
filter(group != "tree" & group != "shrub") %>%
select(name, sla, seedmass, height) %>%
drop_na()
traitsSLA <- traits %>%
filter(group != "tree" & group != "shrub") %>%
select(name, sla) %>%
drop_na()
traitsSM <- traits %>%
filter(group != "tree" & group != "shrub") %>%
select(name, seedmass) %>%
drop_na()
traitsH <- traits %>%
filter(group != "tree" & group != "shrub") %>%
select(name, height) %>%
drop_na()
traitsSRL <- traits %>%
filter(group != "tree" & group != "shrub") %>%
select(name, srl) %>%
drop_na()
traitsRLD <- traits %>%
filter(group != "tree" & group != "shrub") %>%
select(name, rld) %>%
drop_na()
traitsRMF <- traits %>%
filter(group != "tree" & group != "shrub") %>%
select(name, rmf) %>%
drop_na()
traitsAll <- traits %>%
filter(group != "tree" & group != "shrub") %>%
select(name, sla, seedmass, height, srl) %>%
drop_na()
View(traitsSM)
### a LHS -------------------------------------------------------------------------------------------
Tspecies <- semi_join(species, traitsLHS, by = "name")
Ttraits <- semi_join(traitsLHS, Tspecies, by = "name")
Tspecies <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site")
Ttraits <- column_to_rownames(Ttraits, "name")
log_Ttraits <- log(Ttraits)
TdiversityAbu <- dbFD(log_Ttraits, Tspecies, w.abun = T,
calc.FRic = F, calc.FDiv = F, corr = "cailliez")
sites$fdisAbuLHS <- TdiversityAbu$FDis
231 / (250 - 13) #97.5%
### b SLA -------------------------------------------------------------------------------------------
Tspecies <- semi_join(species, traitsSLA, by = "name")
Ttraits <- semi_join(traitsSLA, Tspecies, by = "name")
Tspecies <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site")
Ttraits <- column_to_rownames(Ttraits, "name")
log_Ttraits <- log(Ttraits)
TdiversityAbu <- dbFD(log_Ttraits, Tspecies, w.abun = T,
calc.FRic = F, calc.FDiv = F, corr = "sqrt");
sites$fdisAbuSla <- TdiversityAbu$FDis
sites$cwmAbuSla <- TdiversityAbu$CWM$sla %>%
as.character() %>% as.numeric() %>% exp()
234 / (250 - 13) #98.7%
### c Seed mass -------------------------------------------------------------------------------------------
Tspecies <- semi_join(species, traitsSM, by = "name")
Ttraits <- semi_join(traitsSM, Tspecies, by = "name")
Tspecies <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site")
Ttraits <- column_to_rownames(Ttraits, "name")
log_Ttraits <- log(Ttraits)
TdiversityAbu <- dbFD(log_Ttraits, Tspecies, w.abun = T,
calc.FRic = F, calc.FDiv = F, corr = "sqrt");
sites$fdisAbuSeedmass <- TdiversityAbu$FDis
sites$cwmAbuSeedmass <- TdiversityAbu$CWM$seedmass %>%
as.character() %>% as.numeric() %>% exp()
233/ (250 - 13) #98.3%
### d Canopy height -------------------------------------------------------------------------------------------
Tspecies <- semi_join(species, traitsH, by = "name")
Ttraits <- semi_join(traitsH, Tspecies, by = "name")
Tspecies <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site")
Ttraits <- column_to_rownames(Ttraits, "name")
log_Ttraits <- log(Ttraits)
TdiversityAbu <- dbFD(log_Ttraits, Tspecies, w.abun = T,
calc.FRic = F, calc.FDiv = F, corr = "sqrt");
sites$fdisAbuHeight <- TdiversityAbu$FDis
sites$cwmAbuHeight <- TdiversityAbu$CWM$height %>%
as.character() %>% as.numeric() %>% exp()
235 / (250 - 13) #99.2%
View(traits)
224 / (241 - 12) #97.5%
226 / (241 - 12) #98.7%
226 / (241 - 12) #98.3%
228 / (241 - 12) #99.2%
Tspecies <- semi_join(species, traitsRLD, by = "name")
Ttraits <- semi_join(traitsRLD, Tspecies, by = "name")
Tspecies <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site")
Ttraits <- column_to_rownames(Ttraits, "name")
log_Ttraits <- log(Ttraits)
TdiversityAbu <- dbFD(log_Ttraits, Tspecies, w.abun = T,
calc.FRic = F, calc.FDiv = F, corr = "sqrt");
sites$fdisAbuRld <- TdiversityAbu$FDis
sites$cwmAbuRld <- TdiversityAbu$CWM$rld %>%
as.character() %>% as.numeric() %>% exp()
56 / (241 - 12) #24.7% available
### e Root length density -------------------------------------------------------------------------------------------
Tspecies <- semi_join(species, traitsRLD, by = "name")
Ttraits <- semi_join(traitsRLD, Tspecies, by = "name")
Tspecies <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site")
Ttraits <- column_to_rownames(Ttraits, "name")
log_Ttraits <- log(Ttraits)
TdiversityAbu <- dbFD(log_Ttraits, Tspecies, w.abun = T,
calc.FRic = F, calc.FDiv = F, corr = "sqrt");
Tspecies <- semi_join(species, traitsSRL, by = "name")
Ttraits <- semi_join(traitsSRL, Tspecies, by = "name")
Tspecies <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site")
Ttraits <- column_to_rownames(Ttraits, "name")
log_Ttraits <- log(Ttraits)
TdiversityAbu <- dbFD(log_Ttraits, Tspecies, w.abun = T,
calc.FRic = F, calc.FDiv = F, corr = "sqrt");
sites$fdisAbuSrl <- TdiversityAbu$FDis
sites$cwmAbuSrl <- TdiversityAbu$CWM$srl %>%
as.character() %>% as.numeric() %>% exp()
137 / (241 - 12) #60.8% available
### g Root mass fraction -------------------------------------------------------------------------------------------
Tspecies <- semi_join(species, traitsRMF, by = "name")
Ttraits <- semi_join(traitsRMF, Tspecies, by = "name")
Tspecies <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site")
Ttraits <- column_to_rownames(Ttraits, "name")
log_Ttraits <- log(Ttraits)
TdiversityAbu <- dbFD(log_Ttraits, Tspecies, w.abun = T,
calc.FRic = F, calc.FDiv = F, corr = "sqrt");
sites$fdisAbuRmf <- TdiversityAbu$FDis
sites$cwmAbuRmf <- TdiversityAbu$CWM$rmf %>%
as.character() %>% as.numeric() %>% exp()
157 / (241 - 12) #68.4% available
### h All -------------------------------------------------------------------------------------------
Tspecies <- semi_join(species, traitsAll, by = "name")
Ttraits <- semi_join(traitsAll, Tspecies, by = "name")
Tspecies <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site")
Ttraits <- column_to_rownames(Ttraits, "name")
log_Ttraits <- log(Ttraits)
TdiversityAbu <- dbFD(log_Ttraits, Tspecies, w.abun = T,
calc.FRic = F, calc.FDiv = F, corr = "cailliez")
sites$fdisAbuAll <- TdiversityAbu$FDis
137 / (241 - 12) #60.8% available
TdiversityAbu <- dbFD(log_Ttraits, Tspecies, w.abun = T,
calc.FRic = F, calc.FDiv = F, calc.FEVe = F, corr = "cailliez")
### e Root length density -------------------------------------------------------------------------------------------
Tspecies <- semi_join(species, traitsRLD, by = "name")
Ttraits <- semi_join(traitsRLD, Tspecies, by = "name")
View(Tspecies)
colSums(Tspecies)
colSums(Tspecies[Â´-1])
colSums(Tspecies[,-1])
table(colSums(Tspecies[,-1]))
table(colSums(Tspecies[,-1]) < 1)
table(colSums(Tspecies[,-1]) < .1)
table(colSums(Tspecies[,-1]) < .01)
View(traitsRLD)
View(Tspecies)
Tspecies <- semi_join(species, traitsRLD, by = "name")
Ttraits <- semi_join(traitsRLD, Tspecies, by = "name")
table(colSums(Tspecies[,-1]) < .01)
Tspecies <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site")
Ttraits <- column_to_rownames(Ttraits, "name")
View(Tspecies)
Tspecies <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site") %>%
mutate(n = across_all(sum)) %>%
filter(n == 0)
Tspecies <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site") %>%
mutate(n = across(.x, sum)) %>%
filter(n == 0)
### e Root length density -------------------------------------------------------------------------------------------
Tspecies <- semi_join(species, traitsRLD, by = "name")
Ttraits <- semi_join(traitsRLD, Tspecies, by = "name")
table(colSums(Tspecies[,-1]) < .01)
Tspecies <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site") %>%
mutate(n = across(.x, sum)) %>%
filter(n == 0)
Tspecies <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site") %>%
mutate(n = across(everything, sum)) %>%
filter(n == 0)
Tspecies <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site") %>%
mutate(n = across(everything, sum)) #%>%
Tspecies <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site") %>%
mutate(across(everything, sum)) #%>%
Tspecies <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site") %>%
mutate(across(everything, sum, na.rm = T)) #%>%
Tspecies <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site") %>%
mutate(across(everything(), sum, na.rm = T)) #%>%
View(Tspecies)
Tspecies <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site") %>%
mutate(n = across(everything(), sum, na.rm = T)) #%>%
### e Root length density -------------------------------------------------------------------------------------------
Tspecies <- semi_join(species, traitsRLD, by = "name")
Ttraits <- semi_join(traitsRLD, Tspecies, by = "name")
Tspecies <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site") %>%
mutate(n = across(everything(), sum, na.rm = T)) #%>%
View(Tspecies)
### e Root length density -------------------------------------------------------------------------------------------
Tspecies <- semi_join(species, traitsRLD, by = "name")
Ttraits <- semi_join(traitsRLD, Tspecies, by = "name")
Tspecies2 <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site") %>%
mutate(sum = across(everything(), sum, na.rm = T)) #%>%
mutate(sum = sum(c_across(everything()), na.rm = T) #%>%
mutate(sum = sum(c_across(everything()), na.rm = T) %>%
Tspecies2 <- Tspecies %>%
Tspecies2 <- Tspecies %>%
Tspecies2 <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
mutate(sum = sum(c_across(everything())) %>%
Tspecies2 <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) #%>%
Tspecies2 <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site") #%>%
Tspecies2 <- Tspecies %>%
mutate(sum = sum(c_across(.x)) #%>%
View(Tspecies)
View(Tspecies2)
Tspecies2 <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site") %>%
mutate(total = rowSums(across(where(is.numeric)))) #%>%
Tspecies2 <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site") %>%
mutate(sum = rowSums(across(where(is.numeric)))) #%>%
Tspecies2 <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site") %>%
mutate(sum = rowSums(across(where(is.numeric)))) %>%
filter(sum == 0)
View(Tspecies2)
### e Root length density -------------------------------------------------------------------------------------------
Tspecies <- semi_join(species, traitsRLD, by = "name")
Ttraits <- semi_join(traitsRLD, Tspecies, by = "name")
Tspecies <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site") %>%
mutate(sum = rowSums(across(where(is.numeric)))) %>%
filter(sum != 0)
Ttraits <- column_to_rownames(Ttraits, "name")
log_Ttraits <- log(Ttraits)
TdiversityAbu <- dbFD(log_Ttraits, Tspecies, w.abun = T,
calc.FRic = F, calc.FDiv = F, corr = "sqrt");
sites$fdisAbuRld <- TdiversityAbu$FDis
sites$cwmAbuRld <- TdiversityAbu$CWM$rld %>%
as.character() %>% as.numeric() %>% exp()
56 / (241 - 12) #24.5% available
### f Specific root length -------------------------------------------------------------------------------------------
Tspecies <- semi_join(species, traitsSRL, by = "name")
Ttraits <- semi_join(traitsSRL, Tspecies, by = "name")
### e Root length density -------------------------------------------------------------------------------------------
Tspecies <- semi_join(species, traitsRLD, by = "name")
Ttraits <- semi_join(traitsRLD, Tspecies, by = "name")
Tspecies <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site") %>%
mutate(sum = rowSums(across(where(is.numeric)))) %>%
filter(sum != 0)
Ttraits <- column_to_rownames(Ttraits, "name")
log_Ttraits <- log(Ttraits)
TdiversityAbu <- dbFD(log_Ttraits, Tspecies, w.abun = T,
calc.FRic = F, calc.FDiv = F, corr = "sqrt");
### e Root length density -------------------------------------------------------------------------------------------
Tspecies <- semi_join(species, traitsRLD, by = "name")
Tspecies <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site") %>%
mutate(sum = rowSums(across(where(is.numeric)))) %>%
filter(sum != 0)
Ttraits <- semi_join(traitsRLD, Tspecies, by = "name")
### e Root length density -------------------------------------------------------------------------------------------
Tspecies <- semi_join(species, traitsRLD, by = "name") %>%
column_to_rownames("site") #%>%
View(Tspecies)
View(Tspecies)
### e Root length density -------------------------------------------------------------------------------------------
Tspecies <- semi_join(species, traitsRLD, by = "name") %>%
column_to_rownames("site") %>%
mutate(sum = rowSums(across(where(everything)))) %>%
filter(sum != 0)
### e Root length density -------------------------------------------------------------------------------------------
Tspecies <- semi_join(species, traitsRLD, by = "name") %>%
column_to_rownames("site") %>%
mutate(sum = rowSums(across(everything()))) %>%
filter(sum != 0)
### e Root length density -------------------------------------------------------------------------------------------
Tspecies <- semi_join(species, traitsRLD, by = "name") %>%
column_to_rownames("site") %>%
mutate(sum = rowSums(across(everything()))) %>%
filter(sum != 0)
### e Root length density -------------------------------------------------------------------------------------------
Tspecies <- semi_join(species, traitsRLD, by = "name") %>%
mutate(sum = rowSums(across(everything()))) %>%
filter(sum != 0)
Ttraits <- semi_join(traitsRLD, Tspecies, by = "name")
Tspecies <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site") %>%
Ttraits <- column_to_rownames(Ttraits, "name")
log_Ttraits <- log(Ttraits)
TdiversityAbu <- dbFD(log_Ttraits, Tspecies, w.abun = T,
calc.FRic = F, calc.FDiv = F, corr = "sqrt");
sites$fdisAbuRld <- TdiversityAbu$FDis
### e Root length density -------------------------------------------------------------------------------------------
Tspecies <- semi_join(species, traitsRLD, by = "name") %>%
mutate(sum = rowSums(across(everything()))) %>%
filter(sum != 0)
### e Root length density -------------------------------------------------------------------------------------------
Tspecies <- semi_join(species, traitsRLD, by = "name") %>%
mutate(sum = rowSums(across(everything()))) %>%
filter(sum != 0) %>%
select(-sum)
### e Root length density -------------------------------------------------------------------------------------------
Tspecies <- semi_join(species, traitsRLD, by = "name") %>%
mutate(sum = rowSums(across(where(is.numeric)))) %>%
filter(sum != 0) %>%
select(-sum)
Ttraits <- semi_join(traitsRLD, Tspecies, by = "name")
Tspecies <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site") %>%
Ttraits <- column_to_rownames(Ttraits, "name")
Ttraits <- semi_join(traitsRLD, Tspecies, by = "name")
### e Root length density -------------------------------------------------------------------------------------------
Tspecies <- semi_join(species, traitsRLD, by = "name") %>%
mutate(sum = rowSums(across(where(is.numeric)))) %>%
filter(sum != 0) %>%
select(-sum)
Ttraits <- semi_join(traitsRLD, Tspecies, by = "name")
Tspecies <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site")
Ttraits <- column_to_rownames(Ttraits, "name")
log_Ttraits <- log(Ttraits)
TdiversityAbu <- dbFD(log_Ttraits, Tspecies, w.abun = T,
calc.FRic = F, calc.FDiv = F, corr = "sqrt");
### e Root length density -------------------------------------------------------------------------------------------
Tspecies <- semi_join(species, traitsRLD, by = "name") %>%
mutate(sum = rowSums(across(where(is.numeric)))) %>%
filter(sum != 0) %>%
select(-sum)
Ttraits <- semi_join(traitsRLD, Tspecies, by = "name")
Tspecies <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site")
View(Tspecies)
### e Root length density -------------------------------------------------------------------------------------------
Tspecies <- semi_join(species, traitsRLD, by = "name") %>%
mutate(sum = rowSums(across(where(is.numeric)))) %>%
filter(sum != 0) %>%
select(-sum)
View(Tspecies)
View(Tspecies)
### e Root length density -------------------------------------------------------------------------------------------
Tspecies <- semi_join(species, traitsRLD, by = "name") %>%
mutate(sum = rowSums(across(where(is.numeric)))) #%>%
View(Tspecies)
### e Root length density -------------------------------------------------------------------------------------------
Tspecies <- semi_join(species, traitsRLD, by = "name")
Ttraits <- semi_join(traitsRLD, Tspecies, by = "name")
Tspecies2 <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site") #%>%
View(Tspecies2)
Tspecies2 <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site") %>%
mutate(sum = rowSums(across(where(is.numeric)))) %>%
filter(sum != 0) %>%
select(-sum)
Tspecies <- Tspecies %>%
pivot_longer(-name, "site", "value") %>%
pivot_wider(site, name) %>%
column_to_rownames("site") %>%
mutate(sum = rowSums(across(where(is.numeric)))) %>%
filter(sum != 0) %>%
select(-sum)
Ttraits <- column_to_rownames(Ttraits, "name")
log_Ttraits <- log(Ttraits)
TdiversityAbu <- dbFD(log_Ttraits, Tspecies, w.abun = T,
calc.FRic = F, calc.FDiv = F, corr = "sqrt");
sites$fdisAbuRld <- TdiversityAbu$FDis
rm(list=setdiff(ls(), c("sites", "species", "traits", "tbiPa", "tbiAbu")))
setwd("Z:/Documents/0_Uni/2022_Donaudeiche/3_Aufnahmen_und_Ergebnisse/2022_Danube_dike_experiment/data/processed")
write_csv2(sites, "data_processed_sites.csv")
write_csv2(species, "data_processed_species.csv")
write_csv2(traits, "data_processed_traits.csv")
write_csv2(tbiAbu, "data_processed_tbiAbu.csv")
write_csv2(tbiPa, "data_processed_tbiPa.csv")
speciesS <- read_csv2("data_raw_species_seeded.csv", col_names = T, na = c("", "NA", "na"), col_types =
cols(
.default = col_double(),
name = col_factor()
)) #%>%
### Start ###
#installr::updateR(browse_news = F, install_R = T, copy_packages = T, copy_Rprofile.site = T, keep_old_packages = T, update_packages = T, start_new_R = F, quit_R = T, print_R_versions = T, GUI = F)
rm(list = ls())
setwd("Z:/Documents/0_Uni/2022_Donaudeiche/3_Aufnahmen_und_Ergebnisse/2022_Danube_dike_experiment/data/raw")
speciesS <- read_csv2("data_raw_species_seeded.csv", col_names = T, na = c("", "NA", "na"), col_types =
cols(
.default = col_double(),
name = col_factor()
)) #%>%
speciesS <- read_csv2("data_raw_species_seeded.csv", col_names = T, na = c("", "NA", "na"), col_types =
cols(
.default = col_double(),
side = col_factor(),
id = col_factor()
)) #%>%
