geom_path(
aes(x = NMDS1, y = NMDS2, color = surveyYear_fac),
data = data,
size = 1
) +
facet_grid(
exposition ~ targetType,
labeller = as_labeller(
c(south = "South", north = "North",
"dry_grassland" = "Dry grassland", "hay_meadow" = "Hay meadow")
)
) +
coord_fixed() +
scale_color_manual(values = c(
"yellow1", "orange2", "firebrick3", "deeppink4", "royalblue", "black"
)) +
scale_shape_manual(values = c(
"circle open", "circle open", "circle open", "circle open", "square", "square open"
)) +
scale_alpha_manual(values = c(.3, .3, .3, .3, .7, .8)) +
labs(
x = "NMDS1", fill = "", color = "", shape = "",
y = "NMDS2"
) +
theme_mb())
### Save ###
ggsave(here("outputs", "figures", "figure_nmds_800dpi_16.5x16cm.tiff"),
dpi = 800, width = 16.5, height = 16, units = "cm")
(graph_a <- ggplot() +
geom_point(
aes(y = NMDS2, x = NMDS1, color = surveyYear_fac,
shape = surveyYear_fac, alpha = surveyYear_fac),
data = sites,
cex = 2
) +
geom_path(
aes(x = NMDS1, y = NMDS2, color = surveyYear_fac),
data = data,
size = 1
) +
facet_grid(
exposition ~ targetType,
labeller = as_labeller(
c(south = "South", north = "North",
"dry_grassland" = "Dry grassland", "hay_meadow" = "Hay meadow")
)
) +
coord_fixed() +
scale_color_manual(values = c(
"yellow1", "orange2", "firebrick3", "deeppink4", "royalblue", "grey90"
)) +
scale_shape_manual(values = c(
"circle open", "circle open", "circle open", "circle open", "square", "square open"
)) +
scale_alpha_manual(values = c(.3, .3, .3, .3, .7, .8)) +
labs(
x = "NMDS1", fill = "", color = "", shape = "",
y = "NMDS2"
) +
theme_mb())
(graph_a <- ggplot() +
geom_point(
aes(y = NMDS2, x = NMDS1, color = surveyYear_fac,
shape = surveyYear_fac, alpha = surveyYear_fac),
data = sites,
cex = 2
) +
geom_path(
aes(x = NMDS1, y = NMDS2, color = surveyYear_fac),
data = data,
size = 1
) +
facet_grid(
exposition ~ targetType,
labeller = as_labeller(
c(south = "South", north = "North",
"dry_grassland" = "Dry grassland", "hay_meadow" = "Hay meadow")
)
) +
coord_fixed() +
scale_color_manual(values = c(
"yellow1", "orange2", "firebrick3", "deeppink4", "royalblue", "grey10"
)) +
scale_shape_manual(values = c(
"circle open", "circle open", "circle open", "circle open", "square", "square open"
)) +
scale_alpha_manual(values = c(.3, .3, .3, .3, .7, .8)) +
labs(
x = "NMDS1", fill = "", color = "", shape = "",
y = "NMDS2"
) +
theme_mb())
(graph_a <- ggplot() +
geom_point(
aes(y = NMDS2, x = NMDS1, color = surveyYear_fac,
shape = surveyYear_fac, alpha = surveyYear_fac),
data = sites,
cex = 2
) +
geom_path(
aes(x = NMDS1, y = NMDS2, color = surveyYear_fac),
data = data,
size = 1
) +
facet_grid(
exposition ~ targetType,
labeller = as_labeller(
c(south = "South", north = "North",
"dry_grassland" = "Dry grassland", "hay_meadow" = "Hay meadow")
)
) +
coord_fixed() +
scale_color_manual(values = c(
"yellow1", "orange2", "firebrick3", "deeppink4", "royalblue", "black"
)) +
scale_shape_manual(values = c(
"circle open", "circle open", "circle open", "circle open", "square", "square open"
)) +
scale_alpha_manual(values = c(.3, .3, .3, .3, .7, .7)) +
labs(
x = "NMDS1", fill = "", color = "", shape = "",
y = "NMDS2"
) +
theme_mb())
### Save ###
ggsave(here("outputs", "figures", "figure_nmds_800dpi_16.5x16cm.tiff"),
dpi = 800, width = 16.5, height = 16, units = "cm")
(graph_a <- ggplot() +
geom_point(
aes(y = NMDS2, x = NMDS1, color = surveyYear_fac,
shape = surveyYear_fac, alpha = surveyYear_fac),
data = sites,
cex = 2
) +
geom_path(
aes(x = NMDS1, y = NMDS2, color = surveyYear_fac),
data = data,
size = 1
) +
facet_grid(
exposition ~ targetType,
labeller = as_labeller(
c(south = "South", north = "North",
"dry_grassland" = "Dry grassland", "hay_meadow" = "Hay meadow")
)
) +
coord_fixed() +
scale_color_manual(values = c(
"orange1", "firebrick2", "deeppink3", "green4", "royalblue", "black"
)) +
scale_shape_manual(values = c(
"circle open", "circle open", "circle open", "circle open", "square", "square open"
)) +
scale_alpha_manual(values = c(.3, .3, .3, .3, .7, .7)) +
labs(
x = "NMDS1", fill = "", color = "", shape = "",
y = "NMDS2"
) +
theme_mb())
(graph_a <- ggplot() +
geom_point(
aes(y = NMDS2, x = NMDS1, color = surveyYear_fac,
shape = surveyYear_fac, alpha = surveyYear_fac),
data = sites,
cex = 2
) +
geom_path(
aes(x = NMDS1, y = NMDS2, color = surveyYear_fac),
data = data,
size = 1
) +
facet_grid(
exposition ~ targetType,
labeller = as_labeller(
c(south = "South", north = "North",
"dry_grassland" = "Dry grassland", "hay_meadow" = "Hay meadow")
)
) +
coord_fixed() +
scale_color_manual(values = c(
"orange1", "firebrick2", "deeppink3", "green4", "royalblue", "black"
)) +
scale_shape_manual(values = c(
"circle open", "circle open", "circle open", "circle open", "square", "square open"
)) +
scale_alpha_manual(values = c(.3, .3, .3, .3, .7, .7)) +
labs(
x = "NMDS1", fill = "", color = "", shape = "",
y = "NMDS2"
) +
theme_mb())
(graph_a <- ggplot() +
geom_point(
aes(y = NMDS2, x = NMDS1, color = surveyYear_fac,
shape = surveyYear_fac, alpha = surveyYear_fac),
data = sites,
cex = 2
) +
geom_path(
aes(x = NMDS1, y = NMDS2, color = surveyYear_fac),
data = data,
size = 1
) +
facet_grid(
exposition ~ targetType,
labeller = as_labeller(
c(south = "South", north = "North",
"dry_grassland" = "Dry grassland", "hay_meadow" = "Hay meadow")
)
) +
coord_fixed() +
scale_color_manual(values = c(
"orange1", "firebrick2", "deeppink3", "cyan4", "royalblue", "black"
)) +
scale_shape_manual(values = c(
"circle open", "circle open", "circle open", "circle open", "square", "square open"
)) +
scale_alpha_manual(values = c(.3, .3, .3, .3, .7, .7)) +
labs(
x = "NMDS1", fill = "", color = "", shape = "",
y = "NMDS2"
) +
theme_mb())
(graph_a <- ggplot() +
geom_point(
aes(y = NMDS2, x = NMDS1, color = surveyYear_fac,
shape = surveyYear_fac, alpha = surveyYear_fac),
data = sites,
cex = 2
) +
geom_path(
aes(x = NMDS1, y = NMDS2, color = surveyYear_fac),
data = data,
size = 1
) +
facet_grid(
exposition ~ targetType,
labeller = as_labeller(
c(south = "South", north = "North",
"dry_grassland" = "Dry grassland", "hay_meadow" = "Hay meadow")
)
) +
coord_fixed() +
scale_color_manual(values = c(
"orange1", "firebrick2", "deeppink3", "mediumpurple4", "royalblue", "black"
)) +
scale_shape_manual(values = c(
"circle open", "circle open", "circle open", "circle open", "square", "square open"
)) +
scale_alpha_manual(values = c(.3, .3, .3, .3, .7, .7)) +
labs(
x = "NMDS1", fill = "", color = "", shape = "",
y = "NMDS2"
) +
theme_mb())
(graph_a <- ggplot() +
geom_point(
aes(y = NMDS2, x = NMDS1, color = surveyYear_fac,
shape = surveyYear_fac, alpha = surveyYear_fac),
data = sites,
cex = 2
) +
geom_path(
aes(x = NMDS1, y = NMDS2, color = surveyYear_fac),
data = data,
size = 1
) +
facet_grid(
exposition ~ targetType,
labeller = as_labeller(
c(south = "South", north = "North",
"dry_grassland" = "Dry grassland", "hay_meadow" = "Hay meadow")
)
) +
coord_fixed() +
scale_color_manual(values = c(
"orange1", "firebrick2", "deeppink3", "mediumpurple4", "royalblue", "black"
)) +
scale_shape_manual(values = c(
"circle open", "circle open", "circle open", "circle open", "square", "square open"
)) +
scale_alpha_manual(values = c(.3, .3, .3, .3, .7, .6)) +
labs(
x = "NMDS1", fill = "", color = "", shape = "",
y = "NMDS2"
) +
theme_mb())
### Save ###
ggsave(here("outputs", "figures", "figure_nmds_800dpi_16.5x16cm.tiff"),
dpi = 800, width = 16.5, height = 16, units = "cm")
(graph_a <- ggplot() +
geom_point(
aes(y = NMDS2, x = NMDS1, color = surveyYear_fac,
shape = surveyYear_fac, alpha = surveyYear_fac),
data = sites,
cex = 2
) +
geom_path(
aes(x = NMDS1, y = NMDS2, color = surveyYear_fac),
data = data,
size = 1
) +
facet_grid(
exposition ~ targetType,
labeller = as_labeller(
c(south = "South", north = "North",
"dry_grassland" = "Dry grassland", "hay_meadow" = "Hay meadow")
)
) +
coord_fixed() +
scale_color_manual(values = c(
"orange1", "firebrick2", "deeppink3", "mediumpurple4", "royalblue", "black"
)) +
scale_shape_manual(values = c(
"circle open", "circle open", "circle open", "circle open", "square", "square open"
)) +
scale_alpha_manual(values = c(.3, .3, .3, .3, .7, .6)) +
labs(
x = "NMDS1", y = "NMDS2", fill = "", color = "", shape = "", alpha = ""
) +
theme_mb())
(graph_a <- ggplot() +
geom_point(
aes(y = NMDS2, x = NMDS1, color = surveyYear_fac,
shape = surveyYear_fac, alpha = surveyYear_fac),
data = sites,
cex = 2
) +
geom_path(
aes(x = NMDS1, y = NMDS2, color = surveyYear_fac),
data = data,
size = 1
) +
facet_grid(
exposition ~ targetType,
labeller = as_labeller(
c(south = "South", north = "North",
"dry_grassland" = "Dry grassland", "hay_meadow" = "Hay meadow")
)
) +
coord_fixed() +
scale_color_manual(values = c(
"orange1", "firebrick2", "deeppink3", "mediumpurple4",
"royalblue", "black"
)) +
scale_shape_manual(values = c(
"circle open", "circle open", "circle open", "circle open",
"square", "square open"
)) +
scale_alpha_manual(values = c(.3, .3, .3, .3, .7, .6)) +
labs(
x = "NMDS1", y = "NMDS2", fill = "", color = "", shape = "", alpha = ""
) +
theme_mb())
### Save ###
ggsave(here("outputs", "figures", "figure_nmds_800dpi_16.5x16cm.tiff"),
dpi = 800, width = 16.5, height = 16, units = "cm")
species <- read_csv("data_processed_species.csv",
col_names = TRUE,
na = c("na", "NA", ""))
### Packages ###
library(here)
library(tidyverse)
library(vegan)
### Start ###
rm(list = ls())
setwd(here("data", "processed"))
### Load data ###
sites <- read_csv("data_processed_sites.csv",
col_names = TRUE,
na = c("na", "NA", ""), col_types =
cols(
.default = "?",
id = "f",
plot = "f",
block = "f",
exposition = col_factor(levels = c("north", "south")),
sandRatio = "f",
substrateDepth = "f",
targetType = "c",
seedDensity = "f"
)) %>%
select(
id, plot, block, exposition, sandRatio, substrateDepth, targetType,
seedDensity, surveyYear
) %>%
filter(targetType != "non_ffh") %>%
mutate(
targetType = if_else(targetType == "mixed", "hay_meadow", targetType),
surveyYear_fac = as.character(surveyYear),
surveyYear_fac = if_else(block == "C", "reference", surveyYear_fac),
surveyYear_fac = factor(surveyYear_fac)
)
species <- read_csv("data_processed_species.csv",
col_names = TRUE,
na = c("na", "NA", ""))
### Start ###
rm(list = ls())
setwd(here("data", "processed"))
### Load data ###
sites <- read_csv("data_processed_sites.csv",
col_names = TRUE,
na = c("na", "NA", ""), col_types =
cols(
.default = "?",
id = "f",
plot = "f",
block = "f",
exposition = col_factor(levels = c("north", "south")),
sandRatio = "f",
substrateDepth = "f",
targetType = "c",
seedDensity = "f"
)) %>%
select(
id, plot, block, exposition, sandRatio, substrateDepth, targetType,
seedDensity, surveyYear
) %>%
filter(targetType != "non_ffh") %>%
mutate(
targetType = if_else(targetType == "mixed", "hay_meadow", targetType),
surveyYear_fac = as.character(surveyYear),
surveyYear_fac = if_else(block == "C", "reference", surveyYear_fac),
surveyYear_fac = factor(surveyYear_fac)
)
species <- read_csv("data_processed_species.csv",
col_names = TRUE,
na = c("na", "NA", ""))
species <- read_csv("data_processed_species.csv",
col_names = TRUE,
na = c("na", "NA", ""),
col_types = cols(
.default = "d",
name = "f",
))
species <- read_csv("data_processed_species.csv",
col_names = TRUE,
na = c("na", "NA", ""),
col_types = cols(
.default = "d",
name = "f",
)) %>%
pivot_longer(-name, names_to = "id", values_to = "value") %>%
pivot_wider(names_from = "name", values_from = "value") %>%
arrange(id) %>%
semi_join(data_sites, by = "id") %>%
column_to_rownames("id") %>%
mutate(across(where(is.numeric), ~replace(., 0, NA)))
species <- read_csv("data_processed_species.csv",
col_names = TRUE,
na = c("na", "NA", ""),
col_types = cols(
.default = "d",
name = "f",
)) %>%
pivot_longer(-name, names_to = "id", values_to = "value") %>%
pivot_wider(names_from = "name", values_from = "value") %>%
arrange(id) %>%
semi_join(sites, by = "id") %>%
column_to_rownames("id") %>%
mutate(across(where(is.numeric), ~replace(., 0, NA)))
### Calculate NMDS ###
set.seed(123)
(nmds <- metaMDS(species,
dist = "bray", binary = FALSE, autotransform = TRUE,
try = 99, previous.best = TRUE, na.rm = TRUE))
(nmds <- metaMDS(species,
dist = "bray", binary = FALSE, autotransform = TRUE,
try = 99, previous.best = TRUE, na.rm = TRUE))
(nmds <- metaMDS(species,
dist = "bray", binary = FALSE, autotransform = TRUE,
try = 99, previous.best = TRUE, na.rm = TRUE))
ordi<- nmds
#### b environmental factors --------------------------------------------------
(ef <- envfit(ordi ~ surveyYear_fac + exposition + sandRatio + substrateDepth +
targetType + seedDensity,
data = sites,
permu = 999,
na.rm = TRUE))
plot(ordi, type = "n")
plot(ef, add = TRUE, p. = .05)
text(ordi, dis = "sites", cex = .7)
ordiellipse(ordi, sites$year, kind = "sd", draw = "lines", label = TRUE)
ordiellipse(ordi, sites$surveyYear_fac, kind = "sd", draw = "lines", label = TRUE)
(disp.year <- betadisper(ordi, sites$surveyYear_fac * sites$exposition * sites$targetType))
(disp.year <- betadisper(dist(ordi), sites$surveyYear_fac * sites$exposition * sites$targetType))
#### b environmental factors --------------------------------------------------
(ef <- envfit(ordi ~ exposition + sandRatio + substrateDepth +
targetType + seedDensity,
data = sites,
permu = 999,
na.rm = TRUE))
#### b environmental factors --------------------------------------------------
(ef <- envfit(ordi ~ exposition,
data = sites,
permu = 999,
na.rm = TRUE))
dist <- dist(ordi, method = "bray")
stressplot(ordi) # stress: 0.207
#### b environmental factors --------------------------------------------------
dist <- dist(ordi)
#### b environmental factors --------------------------------------------------
dist <- dist(ordi, type = "euclidean")
#### b environmental factors --------------------------------------------------
dist <- dist(ordi, method = "euclidean")
#### b environmental factors --------------------------------------------------
dist <- dist(ordi, method = "euclidean")
(ef <- envfit(ordi ~ surveyYear_fac + exposition + sandRatio + substrateDepth +
targetType + seedDensity,
data = sites,
permu = 999,
na.rm = TRUE))
