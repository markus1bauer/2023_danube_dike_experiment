# A Preparation ###############################################################
#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
### Packages ###
library(here)
library(tidyverse)
library(naniar)
library(patchwork)
### Start ###
rm(list = ls())
data <- read_csv(
here("data", "processed", "data_processed_sites_spatial.csv"),
col_names = TRUE,
na = c("", "NA", "na"),
col_types =
cols(
target_type = "f"
)
) %>%
select(target_type, survey_year, starts_with("cwm")) %>%
filter(survey_year == "seeded") %>%
pivot_longer(starts_with("cwm"), names_to = "type", values_to = "value") %>%
mutate(
target_type = fct_recode(
target_type,
"Dry\ngrassland" = "dry_grassland",
"Hay\nmeadow" = "hay_meadow"
))
### Functions ###
theme_mb <- function() {
theme(
panel.background = element_rect(fill = "transparent"),
text = element_text(size = 9, color = "black"),
strip.text = element_text(size = 10),
axis.text = element_text(angle = 0, hjust = 0.5, size = 9,
color = "black"),
axis.title = element_text(angle = 0, hjust = 0.5, size = 9,
color = "black"),
axis.line = element_line(),
plot.margin = margin(0, 0, 0, 0, "cm")
)
}
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
# B Plot #######################################################################
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
(graph_a <- data %>%
filter(type == "cwm_abu_sla") %>%
ggplot(aes(x = target_type, y = value, color = target_type)) +
geom_boxplot() +
labs(x = "", y = expression("SLA [mm² mg"^-1*"]")) +
scale_color_manual(breaks = c("Hay\nmeadow", "Dry\ngrassland"),
values = c("#00BFC4", "#F8766D")) +
theme_mb())
(graph_b <- data %>%
filter(type == "cwm_abu_seedmass") %>%
ggplot(aes(x = target_type, y = value, color = target_type)) +
geom_boxplot() +
labs(x = "", y = expression("Seed mass [mg]")) +
scale_color_manual(breaks = c("Hay\nmeadow", "Dry\ngrassland"),
values = c("#00BFC4", "#F8766D")) +
theme_mb())
(graph_c <- data %>%
filter(type == "cwm_abu_height") %>%
ggplot(aes(x = target_type, y = value, color = target_type)) +
geom_boxplot() +
labs(x = "", y = expression("Canopy height [m]")) +
scale_color_manual(breaks = c("Hay\nmeadow", "Dry\ngrassland"),
values = c("#00BFC4", "#F8766D")) +
theme_mb())
graph_a + theme(legend.position = "none") +
graph_b + theme(legend.position = "none") +
graph_c + theme(legend.position = "none") +
plot_annotation(tag_levels = "A") &
theme(plot.tag = element_text(size = 10, face = "bold"))
### Save ###
ggsave(
here("outputs", "figures", "figure_a3_800dpi_16.5x5cm_traits.tiff"),
dpi = 800, width = 16.5, height = 5, units = "cm"
)
### Packages ###
library(here)
library(tidyverse)
library(gt)
### Start ###
rm(list = ls())
### Load data ###
species <- read_csv(
here("data", "processed", "data_processed_species.csv"),
col_names = TRUE,
na = c("", "NA", "na"),
col_types = cols(.default = "?")
)
traits <- read_csv(
here("data", "processed", "data_processed_traits.csv"),
col_names = TRUE,
na = c("", "NA", "na"),
col_types = cols(.default = "?")
)
traits <- read_csv(
here("data", "processed", "data_processed_traits.csv"),
col_names = TRUE,
na = c("", "NA", "na"),
col_types = cols(.default = "?")
) %>%
select(name, target, seeded)
data <- species %>%
mutate(across(where(is.numeric), ~1 * (. != 0))) %>%
mutate(sum = rowSums(across(where(is.numeric)), na.rm = TRUE),
.keep = "unused") %>%
group_by(name) %>%
summarise(sum = sum(sum)) %>%
left_join(traits, by = "name")
data <- species %>%
mutate(across(where(is.numeric), ~1 * (. != 0))) %>%
mutate(sum = rowSums(across(where(is.numeric)), na.rm = TRUE),
.keep = "unused") %>%
group_by(name) %>%
summarise(sum = sum(sum)) %>%
left_join(traits, by = "name") %>%
slect(name, seeded, target, sum)
data <- species %>%
mutate(across(where(is.numeric), ~1 * (. != 0))) %>%
mutate(sum = rowSums(across(where(is.numeric)), na.rm = TRUE),
.keep = "unused") %>%
group_by(name) %>%
summarise(sum = sum(sum)) %>%
left_join(traits, by = "name") %>%
select(name, seeded, target, sum)
(table <- data %>%
mutate(name = str_replace_all(name, "_", " ")) %>%
rename(Name = name, "Presence [# plots]" = sum) %>%
gt() %>%
opt_table_lines("none") %>% ### Set general options ###
tab_options(
table.font.style = "Arial",
table.font.size = px(11),
table.font.color = "black",
column_labels.font.weight = "bold",
data_row.padding = px(4),
table.align = "left",
column_labels.border.top.style = "solid",
table_body.border.top.style = "solid",
table_body.border.bottom.style = "solid",
column_labels.border.top.color = "black",
table_body.border.top.color = "black",
table_body.border.bottom.color = "black",
column_labels.border.top.width = px(2),
table_body.border.top.width = px(1),
table_body.border.bottom.width = px(2)
) %>%
tab_style(
locations = cells_column_labels(),
style = cell_borders(
sides = "top", color = "black", style = "solid", weight = px(1)
)
) %>%
tab_style(
locations = cells_column_labels(),
style = cell_text(align = "center")
) %>%
tab_style(
locations = cells_body(),
style = cell_text(align = "center")
) %>%
tab_style(
locations = cells_body(columns = "Name"),
style = cell_text(align = "left", style = "italic")
) %>%
tab_source_note(source_note = md(
"In total 274 species occured 2018–2021"
)))
View(data)
(table <- data %>%
mutate(name = str_replace_all(name, "_", " ")) %>%
rename(
Name = name,
Seeded = seeded,
"Target species" = target
"Presence [# plots]" = sum
(table <- data %>%
mutate(name = str_replace_all(name, "_", " ")) %>%
rename(
Name = name,
Seeded = seeded,
"Target species" = target,
"Presence [# plots]" = sum
) %>%
sub_missing(missing_text = "") %>%
gt() %>%
opt_table_lines("none") %>% ### Set general options ###
tab_options(
table.font.style = "Arial",
table.font.size = px(11),
table.font.color = "black",
column_labels.font.weight = "bold",
data_row.padding = px(4),
table.align = "left",
column_labels.border.top.style = "solid",
table_body.border.top.style = "solid",
table_body.border.bottom.style = "solid",
column_labels.border.top.color = "black",
table_body.border.top.color = "black",
table_body.border.bottom.color = "black",
column_labels.border.top.width = px(2),
table_body.border.top.width = px(1),
table_body.border.bottom.width = px(2)
) %>%
tab_style(
locations = cells_column_labels(),
style = cell_borders(
sides = "top", color = "black", style = "solid", weight = px(1)
)
) %>%
tab_style(
locations = cells_column_labels(),
style = cell_text(align = "center")
) %>%
tab_style(
locations = cells_body(),
style = cell_text(align = "center")
) %>%
tab_style(
locations = cells_body(columns = "Name"),
style = cell_text(align = "left", style = "italic")
) %>%
tab_source_note(source_note = md(
"In total 274 species occured 2018–2021"
)))
(table <- data %>%
mutate(name = str_replace_all(name, "_", " ")) %>%
rename(
Name = name,
Seeded = seeded,
"Target species" = target,
"Presence [# plots]" = sum
) %>%
sub_missing(columns = 2:3, missing_text = "") %>%
gt() %>%
opt_table_lines("none") %>% ### Set general options ###
tab_options(
table.font.style = "Arial",
table.font.size = px(11),
table.font.color = "black",
column_labels.font.weight = "bold",
data_row.padding = px(4),
table.align = "left",
column_labels.border.top.style = "solid",
table_body.border.top.style = "solid",
table_body.border.bottom.style = "solid",
column_labels.border.top.color = "black",
table_body.border.top.color = "black",
table_body.border.bottom.color = "black",
column_labels.border.top.width = px(2),
table_body.border.top.width = px(1),
table_body.border.bottom.width = px(2)
) %>%
tab_style(
locations = cells_column_labels(),
style = cell_borders(
sides = "top", color = "black", style = "solid", weight = px(1)
)
) %>%
tab_style(
locations = cells_column_labels(),
style = cell_text(align = "center")
) %>%
tab_style(
locations = cells_body(),
style = cell_text(align = "center")
) %>%
tab_style(
locations = cells_body(columns = "Name"),
style = cell_text(align = "left", style = "italic")
) %>%
tab_source_note(source_note = md(
"In total 274 species occured 2018–2021"
)))
data <- species %>%
mutate(across(where(is.numeric), ~1 * (. != 0))) %>%
mutate(sum = rowSums(across(where(is.numeric)), na.rm = TRUE),
.keep = "unused") %>%
group_by(name) %>%
summarise(sum = sum(sum)) %>%
left_join(traits, by = "name") %>%
select(name, seeded, target, sum)
(table <- data %>%
mutate(name = str_replace_all(name, "_", " ")) %>%
rename(
Name = name,
Seeded = seeded,
"Target species" = target,
"Presence [# plots]" = sum
) %>%
sub_missing(columns = 2:3, missing_text = "") %>%
gt() %>%
opt_table_lines("none") %>% ### Set general options ###
tab_options(
table.font.style = "Arial",
table.font.size = px(11),
table.font.color = "black",
column_labels.font.weight = "bold",
data_row.padding = px(4),
table.align = "left",
column_labels.border.top.style = "solid",
table_body.border.top.style = "solid",
table_body.border.bottom.style = "solid",
column_labels.border.top.color = "black",
table_body.border.top.color = "black",
table_body.border.bottom.color = "black",
column_labels.border.top.width = px(2),
table_body.border.top.width = px(1),
table_body.border.bottom.width = px(2)
) %>%
tab_style(
locations = cells_column_labels(),
style = cell_borders(
sides = "top", color = "black", style = "solid", weight = px(1)
)
) %>%
tab_style(
locations = cells_column_labels(),
style = cell_text(align = "center")
) %>%
tab_style(
locations = cells_body(),
style = cell_text(align = "center")
) %>%
tab_style(
locations = cells_body(columns = "Name"),
style = cell_text(align = "left", style = "italic")
) %>%
tab_source_note(source_note = md(
"In total 274 species occured 2018–2021"
)))
(table <- data %>%
mutate(name = str_replace_all(name, "_", " ")) %>%
rename(
Name = name,
Seeded = seeded,
"Target species" = target,
"Presence [# plots]" = sum
) %>%
#sub_missing(columns = 2:3, missing_text = "") %>%
gt() %>%
opt_table_lines("none") %>% ### Set general options ###
tab_options(
table.font.style = "Arial",
table.font.size = px(11),
table.font.color = "black",
column_labels.font.weight = "bold",
data_row.padding = px(4),
table.align = "left",
column_labels.border.top.style = "solid",
table_body.border.top.style = "solid",
table_body.border.bottom.style = "solid",
column_labels.border.top.color = "black",
table_body.border.top.color = "black",
table_body.border.bottom.color = "black",
column_labels.border.top.width = px(2),
table_body.border.top.width = px(1),
table_body.border.bottom.width = px(2)
) %>%
tab_style(
locations = cells_column_labels(),
style = cell_borders(
sides = "top", color = "black", style = "solid", weight = px(1)
)
) %>%
tab_style(
locations = cells_column_labels(),
style = cell_text(align = "center")
) %>%
tab_style(
locations = cells_body(),
style = cell_text(align = "center")
) %>%
tab_style(
locations = cells_body(columns = "Name"),
style = cell_text(align = "left", style = "italic")
) %>%
tab_source_note(source_note = md(
"In total 274 species occured 2018–2021"
)))
(table <- data %>%
mutate(name = str_replace_all(name, "_", " ")) %>%
rename(
Name = name,
Seeded = seeded,
"Target species" = target,
"Presence [# plots]" = sum
) %>%
gt() %>%
sub_missing(columns = 2:3, missing_text = "")
opt_table_lines("none") %>% ### Set general options ###
(table <- data %>%
mutate(name = str_replace_all(name, "_", " ")) %>%
rename(
Name = name,
Seeded = seeded,
"Target species" = target,
"Presence [# plots]" = sum
) %>%
gt() %>%
sub_missing(columns = 2:3, missing_text = "") %>%
opt_table_lines("none") %>% ### Set general options ###
tab_options(
table.font.style = "Arial",
table.font.size = px(11),
table.font.color = "black",
column_labels.font.weight = "bold",
data_row.padding = px(4),
table.align = "left",
column_labels.border.top.style = "solid",
table_body.border.top.style = "solid",
table_body.border.bottom.style = "solid",
column_labels.border.top.color = "black",
table_body.border.top.color = "black",
table_body.border.bottom.color = "black",
column_labels.border.top.width = px(2),
table_body.border.top.width = px(1),
table_body.border.bottom.width = px(2)
) %>%
tab_style(
locations = cells_column_labels(),
style = cell_borders(
sides = "top", color = "black", style = "solid", weight = px(1)
)
) %>%
tab_style(
locations = cells_column_labels(),
style = cell_text(align = "center")
) %>%
tab_style(
locations = cells_body(),
style = cell_text(align = "center")
) %>%
tab_style(
locations = cells_body(columns = "Name"),
style = cell_text(align = "left", style = "italic")
) %>%
tab_source_note(source_note = md(
"In total 274 species occured 2018–2021"
)))
write_csv(data, here("outputs", "tables", "table_a5_specieslist.csv"))
gtsave(table, here("outputs", "tables", "table_a5_specieslist.html"))
### Packages ###
library(here)
library(tidyverse)
library(gt)
### Start ###
rm(list = ls())
### Load data ###
species <- read_csv(
here("data", "processed", "data_processed_species.csv"),
col_names = TRUE,
na = c("", "NA", "na"),
col_types = cols(.default = "?")
)
traits <- read_csv(
here("data", "processed", "data_processed_traits.csv"),
col_names = TRUE,
na = c("", "NA", "na"),
col_types = cols(.default = "?")
) %>%
select(name, target, seeded)
devtools::install_github("dmbates/RePsychLing")
library(RePsychLing)
#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
# A Preparation ###############################################################
#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
### Packages ###
library(here)
library(tidyverse)
library(vegan)
### Start ###
rm(list = setdiff(ls(), c("graph_a", "graph_b", "graph_c", "graph_d", "ordi")))
setwd(here("data", "processed"))
### Functions ###
theme_mb <- function() {
theme(
panel.background = element_rect(fill = "white"),
text = element_text(size = 9, color = "black"),
strip.text = element_text(size = 10),
axis.text = element_text(angle = 0, hjust = 0.5, size = 9,
color = "black"),
axis.title = element_text(angle = 0, hjust = 0.5, size = 9,
color = "black"),
axis.line = element_line(),
legend.key = element_rect(fill = "white"),
legend.position = "bottom",
legend.text = element_text(size = 9),
legend.margin = margin(0, 0, 0, 0, "cm"),
plot.margin = margin(0, 0, 0, 0, "cm")
)
}
vegan_cov_ellipse <- function(cov, center = c(0, 0), scale = 1, npoints = 100) {
theta <- (0:npoints) * 2 * pi / npoints
Circle <- cbind(cos(theta), sin(theta))
t(center + scale * t(Circle %*% chol(cov)))
}
#### Load sites data and model ###
sites_nmds <- read_csv(
"data_processed_sites_nmds.csv",
col_names = TRUE,
na = c("na", "NA", ""),
col_types = cols(.default = "?")
)
sites_nmds %>%
group_by(source, esy) %>%
filter(esy == "R1A" | esy == "R22" | esy == "V38") %>%
count()
base::load(file = here("outputs", "models", "model_nmds.Rdata"))
ordi
